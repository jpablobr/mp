#!/usr/bin/env bash

# Build emacs "TAGS" file in current directory
# based on the projects rvm gemset.
# Requires exuberant ctags.

# RUBYALIAS='/.*alias(_method)?[[:space:]]+:([[:alnum:]_=!?]+),?[[:space:]]+:([[:alnum:]_=!]+)/\\2/f/'
# ctags -R --tag-relative=yes --totals=yes \
#     --extra=+f --fields=+iaS --regex-ruby="$RUBYALIAS" "$@"

set -e

ctags --version >/dev/null 2>&1 || {
    echo "ctags not found or too old." 1>&2
    exit 1
}

rpath=`echo $GEM_PATH | cut -d: -f1`

find $rpath -type f -name '*.rb' | ctags -eL -

exit 0